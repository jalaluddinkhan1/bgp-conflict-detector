# BGP Orchestrator Helm Chart Values
# Production-ready defaults

# Application Configuration
replicaCount: 3

image:
  repository: bgp-orchestrator
  tag: "latest"
  pullPolicy: IfNotPresent

imagePullSecrets: []
nameOverride: ""
fullnameOverride: ""

# Service Account
serviceAccount:
  create: true
  annotations: {}
  name: ""

# Pod Security Context
podSecurityContext:
  fsGroup: 1000
  runAsNonRoot: true
  runAsUser: 1000

# Container Security Context
securityContext:
  allowPrivilegeEscalation: false
  capabilities:
    drop:
      - ALL
  readOnlyRootFilesystem: false
  runAsNonRoot: true
  runAsUser: 1000

# Application Configuration
app:
  port: 8000
  metricsPort: 9090
  workers: 4

# Environment Variables
env:
  - name: DATABASE_URL
    valueFrom:
      secretKeyRef:
        name: bgp-orchestrator-secrets
        key: database-url
  - name: REDIS_URL
    valueFrom:
      secretKeyRef:
        name: bgp-orchestrator-secrets
        key: redis-url
  - name: SECRET_KEY
    valueFrom:
      secretKeyRef:
        name: bgp-orchestrator-secrets
        key: secret-key
  - name: JWT_SECRET_KEY
    valueFrom:
      secretKeyRef:
        name: bgp-orchestrator-secrets
        key: jwt-secret-key
  - name: LOG_LEVEL
    value: "INFO"
  - name: API_HOST
    value: "0.0.0.0"
  - name: API_PORT
    value: "8000"

# Resource Limits and Requests
resources:
  limits:
    cpu: "2"
    memory: "2Gi"
  requests:
    cpu: "1"
    memory: "512Mi"

# Autoscaling (Horizontal Pod Autoscaler)
autoscaling:
  enabled: true
  minReplicas: 3
  maxReplicas: 10
  targetCPUUtilizationPercentage: 70
  targetMemoryUtilizationPercentage: 80

# Pod Disruption Budget
podDisruptionBudget:
  enabled: true
  minAvailable: 2

# Pod Anti-Affinity for High Availability
affinity:
  podAntiAffinity:
    preferredDuringSchedulingIgnoredDuringExecution:
      - weight: 100
        podAffinityTerm:
          labelSelector:
            matchExpressions:
              - key: app
                operator: In
                values:
                  - bgp-orchestrator
          topologyKey: kubernetes.io/hostname

# Node Selector
nodeSelector: {}

# Tolerations
tolerations: []

# Service
service:
  type: ClusterIP
  port: 80
  targetPort: 8000
  annotations: {}

# Ingress
ingress:
  enabled: true
  className: "nginx"
  annotations:
    cert-manager.io/cluster-issuer: "letsencrypt-prod"
    nginx.ingress.kubernetes.io/rate-limit: "100"
    nginx.ingress.kubernetes.io/ssl-redirect: "true"
  hosts:
    - host: bgp-orchestrator.example.com
      paths:
        - path: /
          pathType: Prefix
  tls:
    - secretName: bgp-orchestrator-tls
      hosts:
        - bgp-orchestrator.example.com

# Health Checks
livenessProbe:
  httpGet:
    path: /healthz
    port: http
  initialDelaySeconds: 40
  periodSeconds: 30
  timeoutSeconds: 10
  failureThreshold: 3

readinessProbe:
  httpGet:
    path: /readyz
    port: http
  initialDelaySeconds: 10
  periodSeconds: 10
  timeoutSeconds: 5
  failureThreshold: 3

startupProbe:
  httpGet:
    path: /healthz
    port: http
  initialDelaySeconds: 10
  periodSeconds: 10
  timeoutSeconds: 5
  failureThreshold: 30

# PostgreSQL Sub-chart
postgresql:
  enabled: true
  auth:
    database: bgp_orchestrator
    username: bgp_user
    password: bgp_password
  primary:
    persistence:
      enabled: true
      size: 20Gi
      storageClass: standard
    resources:
      requests:
        memory: "256Mi"
        cpu: "250m"
      limits:
        memory: "1Gi"
        cpu: "1"

# Redis Sub-chart
redis:
  enabled: true
  auth:
    enabled: true
    password: redis_password
  master:
    persistence:
      enabled: true
      size: 8Gi
      storageClass: standard
    resources:
      requests:
        memory: "128Mi"
        cpu: "250m"
      limits:
        memory: "512Mi"
        cpu: "500m"

# Prometheus ServiceMonitor (if using Prometheus Operator)
serviceMonitor:
  enabled: true
  interval: 15s
  scrapeTimeout: 10s
  labels: {}
  annotations: {}

# Additional Labels
labels: {}
annotations: {}

